<!DOCTYPE html>
<html>

<head>
  <meta charset="utf=8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Prayer Board</title>

  <link rel="stylesheet" type="text/css" href="./customStyle.css">    
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootswatch/4.1.1/sketchy/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/7.20.6/sweetalert2.all.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twbs-pagination/1.4.2/jquery.twbsPagination.min.js"></script>
  <script src="Scripts/FetchPrayerRequest.js"></script>
  <script>
      window.fbAsyncInit = function () {
        FB.init({
          appId: '357458545051617',
          cookie: true,
          xfbml: true,
          version: 'v2.12'
        });
  
        FB.AppEvents.logPageView();
  
      };
  
      (function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) { return; }
        js = d.createElement(s); js.id = id;
        js.src = "https://connect.facebook.net/en_US/sdk.js";
        fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'facebook-jssdk'));
        
    </script>
</head>

<body id="mainDiv">

  <script>    
    var whiteList = ['Jason Liu', 'Ivy LQ', 'Lyvan Li', 'Jenny Chung', 'Jia-Li Zhao', 'Ben Kwan', 'David Liang', 'Simion Cheng', 'Janice Chen', 
                    'Ck Fang', 'Xinlong Li', 'Tingting Zhang', 'NoboBee Liang', 'Mankit Yuen', 'Joan Leung', 'Brian A Lau', 'Precious Anne Lee', 
                    'Kapo Chan', 'Carly Chan', 'Jolie Ngan', 'Jia Lynn Liu', 'Jaylen Chen', 'Felix Chan', 'Ernest Ng', 'Melody Cam', 'Lei Lei Zhen',
                    'Michael Zhe Cao', 'Jeff Haolin Deng', 'Edwina Leung', 'Johnson Chen', 'YingTu Chen', 'Cecilia Wong', 'Christina Mai', 'Au Yeung Kwan Ho', 
                    'Mike Yan', 'Cathy Cho', 'Fannie Tong', 'Vincent Jiawen Chen', 'Kaixin Luo', 'Lynette Huang', 'Shelly Chen', 'Karen Zhang', 'Haozheng Chen', 
                    'Jinghui Han', 'Joanna Chan', 'Cara Huang', 'Mingfa Chen', 'Ivan Chen', 'Annie Chen', 'Katy Wong', 'Linda Yuan', 'Daniel Huang', 'Sue Li'];
    function login() {      
      // perms list https://developers.facebook.com/docs/facebook-login/permissions#reference-default
      FB.login(function (response) {
                if (response.status === 'connected') {
                    var url = '/me?fields=id,name,email';
                    FB.api(url, function (response) {
                        if(whiteList.includes(response.name)){
                          alert("log in successfully");
                          console.log('id:' + response.id + ' name:' + response.name + ' email: ' + response.email)
                        }else{
                          alert("User is not in H2o + 2 Fellowship Group");
                        }                  
                    });
                }
                else {
                    alert("User did not login successfully");
                }
            }, { scope: 'email' }); /* perms changed to scope */
    }
    

    function logout() {
      FB.logout(function (response) {
        // user is now logged out
      });

      
    }
  </script>
  <div class="navbar navbar-expand-lg fixed-top navbar-light bg-light">
    <div class="container">
      <a href="./Index.html" class="navbar-brand">H2O Fellowship</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive"
        aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" href="./About.html">About</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <div class="tab-content">
    <div class="tab-pane fade active show" id="prayerBoardTab">
      <div class="container">
        <div class="tab-pane fade show active jumbotron" id="prayerBoard">
            
          <h1 class="display-3">H2O Prayer Board</h1>
          <button class="btn btn-primary col-xs-6"  onclick="login();">Login Facebook</button>
                    
        </div>
      </div>
    </div>
  </div>
  </div>

</body>

</html>